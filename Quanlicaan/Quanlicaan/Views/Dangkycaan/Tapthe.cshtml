@model List<Quanlicaan.Models.ModelsPage.DkiCaAnTapTheModel>
@using Quanlicaan.Models.Session
@using System.Data;
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    var info = (UserSession)Session["UserSession"];
    int a = 1;
    var now = DateTime.Now;

}

<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Tapthe</title>
    <link rel="stylesheet" href="~/css/main.css">

</head>


<body>
    <div class="d-flex flex-column m-lg-4 ">
        <div style="margin-top:30px">
            <h2 class="title">ĐĂNG KÍ ĂN CA TẬP THỂ</h2>
        </div>
        <div class="d-flex justify-content-between px-3" style="margin-bottom:20px">
            <h4>  Nhân viên đăng kí : @info.hoTen</h4>
            <h4>  Ngày đăng kí :  @DateTime.Now.ToShortDateString()</h4>

        </div>
        @using (Html.BeginForm("DkiTapThe", "Dangkycaan", FormMethod.Post))
        {
            <table class="table table-bordered">
                <thead class="thead-dark">
                    <tr>
                        <th scope="col">STT</th>
                        <th scope="col">Mã nhân viên</th>
                        <th scope="col">Tên nhân viên</th>
                        <th scope="col">Tên Phòng Ban</th>
                        <th scope="col">Chọn</th>
                        <th scope="col">Đăng kí ca ăn</th>

                    </tr>
                </thead>
                <tbody>
                    @for (int k = 0; k < Model.Count; k++)
                    {
                        int j = 1;
                        <tr>
                            <td>@a</td>
                            <td>
                                @Html.HiddenFor(m => Model[k].IDUser)
                                @Model[k].IDUser
                            </td>
                            <td>
                                @Html.HiddenFor(m => Model[k].hoTen)
                                @Model[k].hoTen
                            </td>
                            <td>
                                @Html.HiddenFor(m => Model[k].phongBan)
                                @Model[k].phongBan
                            </td>
                            <td>
                                @Html.CheckBoxFor(model => Model[k].TrangThai, new { id = "checkbbb" })
                            </td>
                            <td>
                                <table>
                                    @for (int i = 0; i < Model[k].ListCaAn.Count; i++)
                                    {

                                        if (now.TimeOfDay > Model[k].ListCaAn[i].Thoigian.TimeOfDay)
                                        {
                                            <tr style=" display: flex; align-items: flex-end;" id="check_caan">
                                                <td>
                                                    @Html.CheckBoxFor(m => Model[k].ListCaAn[i].IsChecked, new { disabled = "disabled" })
                                                    @Html.HiddenFor(m => Model[k].ListCaAn[i].ID, new { disabled = "disabled" })
                                                    @Html.HiddenFor(m => Model[k].ListCaAn[i].Thoigian, new { disabled = "disabled" })

                                                </td>
                                                <td style=" margin-right :10px">
                                                    Ca @j
                                                </td>
                                                <td>
                                                    <h6> Quá thời gian đăng kí ca ăn</h6>
                                                    @Html.TextBoxFor(m => Model[k].ListCaAn[i].SoluongSuatan, new { disabled = "disabled", htmlAttributes = new { @class = "form-control", placeholder = "Số lượng suất ăn" } })
                                                </td>

                                            </tr>
                                            j++;
                                        }
                                        else
                                        {
                                            <tr style=" display: flex; align-items: flex-end;">
                                                <td>
                                                    @Html.CheckBoxFor(m => Model[k].ListCaAn[i].IsChecked)
                                                    @Html.HiddenFor(m => Model[k].ListCaAn[i].ID)
                                                    @Html.HiddenFor(m => Model[k].ListCaAn[i].Thoigian)

                                                </td>
                                                <td style=" margin-right :10px">
                                                    Ca @j
                                                </td>
                                                <td>
                                                    <h6>Số lượng suất ăn</h6>
                                                    @Html.TextBoxFor(m => Model[k].ListCaAn[i].SoluongSuatan, new { htmlAttributes = new { @class = "form-control", placeholder = "Số lượng suất ăn", id = " Check_caan" } })
                                                </td>

                                            </tr>
                                            j++;
                                        }
                                    }
                                </table>
                            </td>

                        </tr>
                        a++;
                    }
             </tbody>
            </table>

            <div class="btn_submit_back">
                <button type="submit" class="submit-btn">Đăng kí  ca ăn</button>
                <button class="submit-btn"> <a style="text-decoration:none ; color:white " href="@Url.Action("Home", "Home")">Cance</a></button>

            </div>

         }
    </div>

               
 </body>
</html>
